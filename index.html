<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <title>LionLead ‚Äì Leadership Onboarding Companion</title>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f4f9;
            color: #333;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        #setup-form,
        #daily-card {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        input,
        select,
        button {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
        }

        button {
            background-color: #333;
            color: white;
            cursor: pointer;
            font-weight: bold;
        }

        button:hover {
            background-color: #555;
        }

        .actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .actions button {
            flex: 1;
        }
    </style>
</head>

<body>
    <header>
        <h1>ü¶Å LionLead</h1>
        <p>–í–∞—à AI-–∫–æ–º–ø–∞–Ω—å–æ–Ω –¥–ª—è –ø–µ—Ä–≤—ã—Ö 30 –¥–Ω–µ–π –ª–∏–¥–µ—Ä—Å—Ç–≤–∞.</p>
    </header>

    <div id="setup-form">
        <h2>–ù–∞—á–Ω–µ–º?</h2>
        <input type="text" id="user-name" placeholder="–í–∞—à–µ –∏–º—è">
        <select id="user-role">
            <option value="Product Lead">Product Lead</option>
            <option value="Engineering Lead">Engineering Lead</option>
        </select>
        <button onclick="startJourney()">–ù–∞—á–∞—Ç—å</button>
    </div>

    <div id="daily-card" style="display: none;">
        <h3 id="day-title">Day X</h3>
        <p id="insight"></p>
        <p id="action"></p>
        <p id="script"></p>
        <p id="reflection-question"></p>
        <div class="actions">
            <button onclick="nextDay('done')">‚úÖ Done</button>
            <button onclick="requestHelp()">ü§î Need help (Future MVP)</button>
            <button onclick="nextDay('skip')">‚è≠Ô∏è Skip</button>
        </div>
    </div>

    <script>
        // === –õ–û–ì–ò–ö–ê –§–†–û–ù–¢–ï–ù–î–ê (JS) ===

        // 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ URL –≤–∞—à–µ–π Serverless Function Vercel
        const API_ENDPOINT = '/api/coach';

        let currentDay = 1;

        // Generate or retrieve User ID
        let userId = localStorage.getItem('lionlead_user_id');
        if (!userId) {
            userId = 'user_' + Math.random().toString(36).substr(2, 9);
            localStorage.setItem('lionlead_user_id', userId);
        }
        console.log("User ID:", userId);

        function getWeekTheme(day) {
            if (day >= 1 && day <= 7) return "Identity Shift & Expectations";
            if (day >= 8 && day <= 14) return "Communication & Transparency";
            if (day >= 15 && day <= 21) return "Feedback & Trust";
            if (day >= 22 && day <= 28) return "Delegation, Priorities & Boundaries";
            return "Reflection & Next-Month Plan";
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–∏–º–∏—Ç–∞—Ü–∏—è Session Storage)
        function loadProgress() {
            // –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ª–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ localStorage
            // –î–ª—è MVP –ø—Ä–æ—Å—Ç–æ –Ω–∞—á–Ω–µ–º —Å Day 1
            document.getElementById('setup-form').style.display = 'block';
            document.getElementById('daily-card').style.display = 'none';
        }

        async function startJourney() {
            const role = document.getElementById('user-role').value;
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å (role, currentDay = 1) –≤ localStorage

            document.getElementById('setup-form').style.display = 'none';
            document.getElementById('daily-card').style.display = 'block';
            await loadDailyContent(currentDay, role);
        }

        async function loadDailyContent(day, role) {
            const theme = getWeekTheme(day);
            document.getElementById('day-title').textContent = `Day ${day} of 30`;
            document.getElementById('insight').textContent = "Loading...";

            // –í—ã–∑–æ–≤ Serverless Function
            try {
                const response = await fetch(API_ENDPOINT, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ day: `Day ${day}`, role: role, theme: theme, userId: userId })
                });

                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    throw new Error(errorData.details || errorData.error || `API Error: ${response.status}`);
                }

                const data = await response.json();

                // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
                document.getElementById('day-title').textContent = data.day_title;
                document.getElementById('insight').innerHTML = `<strong>Insight:</strong> ${data.insight}`;
                document.getElementById('action').innerHTML = `<strong>Action:</strong> ${data.micro_action}`;
                document.getElementById('script').innerHTML = data.suggested_script ? `<strong>Script:</strong> ${data.suggested_script}` : '';
                document.getElementById('reflection-question').innerHTML = `<strong>Reflection:</strong> ${data.reflection_question}`;

            } catch (error) {
                console.error("Error loading content:", error);
                document.getElementById('insight').innerHTML = `<strong>–û—à–∏–±–∫–∞:</strong> ${error.message || '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ API.'}`;
            }
        }

        function nextDay(action) {
            // –õ–æ–≥–∏–∫–∞ –¥–ª—è Done/Skip: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞, —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –¥–Ω—è
            currentDay++;
            if (currentDay <= 30) {
                const role = document.getElementById('user-role').value; // –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ localStorage
                loadDailyContent(currentDay, role);
            } else {
                alert("–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏ 30-–¥–Ω–µ–≤–Ω—ã–π –ø—É—Ç—å LionLead!");
                // –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
            }
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        loadProgress(); 
    </script>
</body>

</html>